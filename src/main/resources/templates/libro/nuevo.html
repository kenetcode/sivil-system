<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: layout ('Nuevo Libro - Sistema SIVIL', ~{::content})}">
<head>
    <title>Nuevo Libro - Sistema SIVIL</title>
</head>
<body>
<div th:fragment="content">
    <div class="row mb-4">
        <div class="col-12">
            <h2><i class="bi bi-journal-plus"></i> Registrar Nuevo Libro</h2>
            <p class="text-muted">Complete todos los campos obligatorios (*)</p>
        </div>
    </div>

    <!-- Mensaje de error -->
    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

    <form th:action="@{/libros}" th:object="${form}" method="post" class="row g-3">

        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <div class="col-md-4">
            <label class="form-label">Código *</label>
            <input class="form-control" th:field="*{codigo_libro}" maxlength="20" required/>
            <div class="text-danger" th:if="${#fields.hasErrors('codigo_libro')}" th:errors="*{codigo_libro}"></div>
        </div>

        <div class="col-md-8">
            <label class="form-label">Título *</label>
            <input class="form-control" th:field="*{titulo}" maxlength="200" required/>
            <div class="text-danger" th:if="${#fields.hasErrors('titulo')}" th:errors="*{titulo}"></div>
        </div>

        <div class="col-md-6">
            <label class="form-label">Autor *</label>
            <input class="form-control" th:field="*{autor}" maxlength="100" required/>
            <div class="text-danger" th:if="${#fields.hasErrors('autor')}" th:errors="*{autor}"></div>
        </div>

        <div class="col-md-3">
            <label class="form-label">Año publicación *</label>
            <input type="number" class="form-control" th:field="*{año_publicacion}" min="1900" max="2030" required/>
            <div class="text-danger" th:if="${#fields.hasErrors('año_publicacion')}" th:errors="*{año_publicacion}"></div>
        </div>

        <div class="col-md-3">
            <label class="form-label">Precio *</label>
            <input type="number" step="0.01" class="form-control" th:field="*{precio}" placeholder="0.00" min="0" required/>
            <div class="text-danger" th:if="${#fields.hasErrors('precio')}" th:errors="*{precio}"></div>
        </div>

        <div class="col-md-3">
            <label class="form-label">Stock inicial *</label>
            <input type="number" class="form-control" th:field="*{cantidad_stock}" min="0" value="0" required/>
            <div class="text-danger" th:if="${#fields.hasErrors('cantidad_stock')}" th:errors="*{cantidad_stock}"></div>
        </div>

        <div class="col-md-3">
            <label class="form-label">Categoría</label>
            <input class="form-control" th:field="*{categoria}" maxlength="50" placeholder="Ej: Ficción, Educativo"/>
        </div>

        <div class="col-md-3">
            <label class="form-label">Editorial</label>
            <input class="form-control" th:field="*{editorial}" maxlength="100" placeholder="Ej: Planeta, Alfaguara"/>
        </div>

        <div class="col-md-6">
            <label class="form-label">URL de imagen</label>
            <input type="url" class="form-control" th:field="*{imagen_url}" maxlength="500" placeholder="https://ejemplo.com/imagen.jpg"/>
        </div>

        <div class="col-12">
            <label class="form-label">Descripción</label>
            <textarea class="form-control" th:field="*{descripcion}" rows="3" placeholder="Descripción del libro (opcional)"></textarea>
        </div>

        <div class="col-12 d-flex gap-2">
            <button type="submit" class="btn btn-primary">
                <i class="bi bi-save"></i> Guardar Libro
            </button>
            <a th:href="@{/stock}" class="btn btn-secondary">
                <i class="bi bi-arrow-left"></i> Cancelar
            </a>
        </div>
    </form>
</div>
</body>
</html>